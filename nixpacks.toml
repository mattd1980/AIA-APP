[variables]
# Pin Node 20 (Vite 7 / frontend requires 20.19+)
NODE_VERSION = "20"
NIXPACKS_NODE_VERSION = "20"

[phases.setup]
nixPkgs = ["nodejs"]

[phases.install]
cmds = [
  "echo '=== Installing backend ===' && cd backend && npm install",
  "echo '=== Installing frontend ===' && cd frontend && npm install"
]

[phases.build]
cmds = ["echo '=== Building backend ===' && cd backend && npm run build"]

[start]
cmd = "cd backend && npm run railway"
